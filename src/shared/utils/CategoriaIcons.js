/**
 * Biblioteca Unificada de √çcones para Categorias iPoupei
 * üéØ Combina o melhor das duas bibliotecas existentes
 * üì± Base √∫nica para Mobile e Web
 * üé® ~600+ √≠cones organizados por categoria
 * ‚úÖ Compat√≠vel com sistema atual do modal
 */

/**
 * √çcones simples profissionais - Material Design style
 * Ideal para destacar cores de categoria e visual clean
 */
const iconesMaterial = {
  'financas': [
    'attach_money', 'euro_symbol', 'credit_card', 'account_balance_wallet',
    'account_balance', 'savings', 'monetization_on', 'payment',
    'trending_up', 'trending_down', 'show_chart', 'analytics',
    'assessment', 'bar_chart', 'timeline', 'business_center',
    'work_outline', 'corporate_fare', 'apartment', 'star_outline',
    'diamond', 'emoji_events', 'military_tech'
  ],
  
  'alimentacao': [
    'restaurant', 'fastfood', 'dinner_dining', 'lunch_dining',
    'breakfast_dining', 'local_dining', 'room_service', 'takeout_dining',
    'local_cafe', 'local_bar', 'wine_bar', 'coffee',
    'emoji_food_beverage', 'local_drink', 'liquor', 'sports_bar',
    'local_grocery_store', 'shopping_cart', 'store', 'storefront',
    'kitchen', 'microwave', 'blender', 'countertops'
  ],
  
  'transporte': [
    'directions_car', 'car_rental', 'local_taxi', 'car_repair',
    'garage', 'local_gas_station', 'local_parking', 'traffic',
    'directions_bus', 'directions_subway', 'train', 'tram',
    'directions_railway', 'subway', 'bus_alert', 'commute',
    'directions_bike', 'motorcycle', 'electric_scooter', 'skateboarding',
    'flight', 'local_airport', 'directions_boat', 'sailing'
  ],
  
  'moradia': [
    'home', 'house', 'apartment', 'villa', 'cottage', 'cabin',
    'bungalow', 'chalet', 'bed', 'chair', 'table_restaurant',
    'weekend', 'living', 'kitchen', 'bathroom', 'balcony',
    'electrical_services', 'plumbing', 'carpenter', 'handyman',
    'build', 'construction', 'engineering', 'architecture',
    'lock', 'security', 'vpn_key', 'key'
  ],
  
  'saude': [
    'local_hospital', 'medical_services', 'medication', 'vaccines',
    'healing', 'monitor_heart', 'emergency', 'psychology',
    'biotech', 'science', 'medical_information', 'health_and_safety',
    'masks', 'sanitizer', 'thermostat', 'fitness_center',
    'sports_gymnastics', 'directions_run', 'directions_walk', 'self_improvement',
    'spa', 'hot_tub', 'pool'
  ],
  
  'educacao': [
    'school', 'auto_stories', 'menu_book', 'library_books',
    'book', 'bookmark_outline', 'class', 'groups',
    'edit', 'create', 'draw', 'format_paint',
    'highlight', 'text_fields', 'title', 'article',
    'computer', 'laptop', 'tablet', 'phone_android',
    'cast_for_education', 'screen_share', 'slideshow'
  ],
  
  'trabalho': [
    'work_outline', 'business_center', 'corporate_fare', 'apartment',
    'domain', 'meeting_room', 'co_present', 'computer',
    'laptop', 'desktop_windows', 'keyboard', 'mouse',
    'phone', 'headset', 'print', 'description',
    'article', 'assignment', 'folder', 'folder_open',
    'insert_drive_file', 'picture_as_pdf', 'text_snippet', 'email',
    'message', 'chat', 'video_call', 'call', 'contacts'
  ],
  
  'outros': [
    'folder', 'folder_open', 'create_new_folder', 'topic',
    'label', 'bookmark_outline', 'push_pin', 'flag',
    'star_outline', 'grade', 'emoji_events', 'diamond',
    'auto_awesome', 'bolt', 'flash_on', 'wb_sunny',
    'arrow_upward', 'arrow_downward', 'arrow_forward', 'arrow_back',
    'refresh', 'sync', 'swap_horiz', 'compare_arrows'
  ]
};

/**
 * √çcones emoji coloridos e expressivos
 * Sistema principal usado no modal atual
 */
const iconesEmoji = {
  // FINAN√áAS - S√≠mbolos financeiros e investimentos
  'financas': [
    'üí∞', 'üíµ', 'üí¥', 'üí∂', 'üí∑', 'üí≥', 'üíé', 'ü™ô',
    'üìä', 'üìà', 'üìâ', 'üíπ', 'üè¶', 'üí∏', 'üéØ', '‚≠ê',
    '‚ú®', 'üåü', 'üí•', 'üöÄ', '‚ö°', 'üî•', 'üí´', 'üèÜ'
  ],

  // ALIMENTA√á√ÉO - Comidas, bebidas e refei√ß√µes
  'alimentacao': [
    'üçΩÔ∏è', 'üçï', 'üçî', 'üçü', 'üåÆ', 'üç±', 'ü•ó', 'üçú',
    'üçñ', 'üçá', 'ü•ò', 'üç≤', 'ü•ô', 'üåØ', 'ü•™', 'üçû',
    'ü•ñ', 'ü•®', 'üßÄ', 'ü•ì', 'üç≥', 'ü•û', 'üßá', 'üçØ',
    'ü•õ', '‚òï', 'üçµ', 'üßÉ', 'ü•§', 'üç∑', 'üç∫', 'ü•Ç',
    'üçé', 'üçå', 'üçä', 'üçì', 'ü•ù', 'üçë', 'üçí', 'ü•≠'
  ],

  // TRANSPORTE - Ve√≠culos e locomo√ß√£o
  'transporte': [
    'üöó', 'üöï', 'üöô', 'üöå', 'üöé', 'üèçÔ∏è', 'üö≤', 'üõµ',
    '‚úàÔ∏è', 'üö¢', 'üöÅ', 'üöÉ', 'üöÑ', 'üöÖ', 'üöÜ', 'üöá',
    'üöà', 'üöâ', 'üöä', 'üöù', 'üöû', 'üöã', 'üöò', 'üöñ',
    'üöõ', 'üöö', 'üöê', 'üõª', 'üèéÔ∏è', 'üöì', 'üöë', 'üöí',
    '‚õΩ', 'üÖøÔ∏è', 'üöß', 'üõ£Ô∏è', 'üó∫Ô∏è', 'üß≠', 'üõ¥', 'üõπ'
  ],

  // MORADIA - Casa, m√≥veis e utens√≠lios dom√©sticos
  'moradia': [
    'üè†', 'üè°', 'üè¢', 'üè®', 'üè©', 'üè™', 'üè¨', 'üè≠',
    'üõèÔ∏è', 'üõãÔ∏è', 'ü™ë', 'üöø', 'üõÅ', 'üöΩ', 'ü™û', 'üö™',
    'ü™ü', 'üîë', 'üóùÔ∏è', 'üîí', 'üí°', '‚ö°', 'üîå', 'üíß',
    'üî•', 'üì°', 'üì∂', 'üåê', '‚öôÔ∏è', 'üîß', 'üî®', 'ü™õ',
    'üßπ', 'üßΩ', 'üß¥', 'üßª', 'üóëÔ∏è', '‚ôªÔ∏è', 'ü™¥', 'üåø'
  ],

  // SA√öDE - Medicina e bem-estar
  'saude': [
    'üè•', '‚öïÔ∏è', 'ü©∫', 'üíä', 'üíâ', 'üå°Ô∏è', 'üß¨', 'üß™',
    'üî¨', 'ü¶∑', 'ü¶¥', 'üß†', 'üí™', 'üßò', 'üíö', 'üë®‚Äç‚öïÔ∏è',
    'üë©‚Äç‚öïÔ∏è', 'üöë', 'ü©π', 'üßª', 'ü™•', 'üß¥', 'üíÜ', 'ü§∏',
    'üèÉ', 'üö∂', 'üßò‚Äç‚ôÄÔ∏è', 'üßò‚Äç‚ôÇÔ∏è', 'üí§', 'üõå', 'üçé', 'ü•ó'
  ],

  // EDUCA√á√ÉO - Estudos e aprendizado
  'educacao': [
    'üìö', 'üìñ', 'üìù', '‚úèÔ∏è', '‚úíÔ∏è', 'üñãÔ∏è', 'üñäÔ∏è', 'üñçÔ∏è',
    'üìÑ', 'üìÉ', 'üìë', 'üìä', 'üìà', 'üìã', 'üìå', 'üìç',
    'üìé', '‚úÇÔ∏è', 'üéì', 'üéí', 'üè´', 'üíª', '‚å®Ô∏è', 'üñ±Ô∏è',
    'üì±', 'üì∫', 'üñ•Ô∏è', 'üíæ', 'üìÄ', 'üîç', 'üîé', 'üìê',
    'üìè', 'üßÆ', 'üî¨', 'üß¨', 'üåç', 'üåé', 'üåè', 'üó∫Ô∏è'
  ],

  // TRABALHO - Atividades profissionais
  'trabalho': [
    'üíº', 'üëî', 'üíª', '‚å®Ô∏è', 'üñ•Ô∏è', 'üìä', 'üìà', 'üìâ',
    'üí∞', 'üè¢', 'üìã', 'üìù', '‚òéÔ∏è', 'üìû', 'üí≥', '‚öôÔ∏è',
    'üîß', 'üìß', 'üíå', 'üì†', 'üñ®Ô∏è', 'üì∫', 'üìª', '‚è∞',
    'üïê', 'üìÖ', 'üìÜ', 'üóìÔ∏è', 'üìá', 'üóÇÔ∏è', 'üìÅ', 'üìÇ',
    'üóÑÔ∏è', 'üìé', 'üìå', '‚úÇÔ∏è', 'üìè', 'üìê', 'üîç', 'üí°'
  ],

  // LAZER - Entretenimento e divers√£o
  'lazer': [
    'üéâ', 'üéÆ', 'üïπÔ∏è', 'üé≤', 'üéØ', 'üé™', 'üé®', 'üé≠',
    'üé¨', 'üé§', 'üéß', 'üéµ', 'üé∂', 'üéº', 'üéπ', 'ü•Å',
    'üé∑', 'üé∫', 'üé∏', 'üéª', 'üçø', 'üé´', 'üéüÔ∏è', 'üéä',
    'üéà', 'üéÅ', 'üéÄ', 'üîÆ', 'ü™Ñ', 'üé™', 'üé°', 'üé¢',
    'üé†', 'üé≥', 'üèì', 'üé±', 'üÉè', 'üß©', 'ü™Ä', 'ü™Å'
  ],

  // ESPORTES - Atividades f√≠sicas
  'esportes': [
    '‚öΩ', 'üèÄ', 'üèà', '‚öæ', 'ü•é', 'üéæ', 'üèê', 'üèâ',
    'ü•è', 'üé±', 'üèì', 'üè∏', 'üèí', 'üèë', 'ü•ç', 'üèè',
    'ü•ä', 'ü•ã', 'üéΩ', 'üõπ', 'üõ∑', '‚õ∏Ô∏è', 'ü•å', 'üéø',
    'üèÜ', 'ü•á', 'ü•à', 'ü•â', 'üèÖ', 'üéñÔ∏è', '‚≠ê', 'üåü',
    'üí™', 'üèÉ‚Äç‚ôÇÔ∏è', 'üèÉ‚Äç‚ôÄÔ∏è', 'üö¥‚Äç‚ôÇÔ∏è', 'üö¥‚Äç‚ôÄÔ∏è', 'üèä‚Äç‚ôÇÔ∏è', 'üèä‚Äç‚ôÄÔ∏è', 'üßó‚Äç‚ôÇÔ∏è'
  ],

  // FAM√çLIA - Relacionamentos e cuidados
  'familia': [
    'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üë™', 'üë´', 'üë¨', 'üë≠', 'üíë', 'üíè', 'üë∂',
    'üëß', 'üßí', 'üë¶', 'üë©', 'üßë', 'üë®', 'üßì', 'üë¥',
    'üëµ', 'üíê', 'üéÇ', 'üíù', 'üíï', 'üíñ', 'üíó', 'üíò',
    'üíô', 'üíö', 'üíõ', 'üß°', 'üíú', 'üñ§', 'ü§ç', 'ü§é',
    '‚ù§Ô∏è', 'ü©∑', 'üíî', '‚ù£Ô∏è', 'üíü', '‚ô•Ô∏è', 'üíØ', 'üí´'
  ],

  // PETS - Animais de estima√ß√£o
  'pets': [
    'üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº',
    'üê®', 'üêØ', 'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêµ', 'üêæ',
    'ü¶¥', 'ü•é', 'üè†', 'üíñ', 'üêï', 'üêà', 'üêá', 'üêÄ',
    'üêÅ', 'üêøÔ∏è', 'ü¶î', 'üêâ', 'üê≤', 'ü¶Ñ', 'üêù', 'üêõ',
    'ü¶ã', 'üêå', 'üêû', 'üêú', 'ü¶ó', 'üï∑Ô∏è', 'üï∏Ô∏è', 'ü¶Ç'
  ],

  // VIAGEM - Turismo e aventuras
  'viagem': [
    '‚úàÔ∏è', 'üõ´', 'üõ¨', 'ü™Ç', 'üí∫', 'üöÅ', 'üöü', 'üö†',
    'üö°', 'üõ∂', '‚õµ', 'üö§', 'üõ•Ô∏è', 'üõ≥Ô∏è', '‚õ¥Ô∏è', 'üö¢',
    'üèñÔ∏è', 'üèùÔ∏è', 'üå¥', 'üóª', 'üèîÔ∏è', '‚õ∞Ô∏è', 'üèïÔ∏è', '‚õ∫',
    'üß≥', 'üéí', 'üëï', 'üëñ', 'üëó', 'üëû', 'üß¢', 'üëí',
    'üï∂Ô∏è', 'üì∑', 'üì∏', 'üé•', 'üìπ', 'üì±', 'üó∫Ô∏è', 'üß≠'
  ],

  // COMPRAS - Produtos e servi√ßos
  'compras': [
    'üõçÔ∏è', 'üõí', 'üè™', 'üè¨', 'üí≥', 'üí∞', 'üíµ', 'üèß',
    'üëï', 'üëñ', 'üëó', 'üëû', 'üë†', 'üß¥', 'üß∑', 'üßπ',
    'üß∫', 'üßª', 'üßº', 'üíÑ', 'üíã', 'üëÑ', 'üëÅÔ∏è', 'üëÉ',
    'üëÇ', 'ü¶∑', 'ü¶¥', 'üß†', 'ü´Ä', 'ü´Å', 'ü¶µ', 'ü¶∂',
    'üëã', 'ü§ö', 'üñêÔ∏è', '‚úã', 'üññ', 'üëå', 'ü§å', 'ü§è'
  ],

  // OUTROS - Diversos e gen√©ricos
  'outros': [
    'üìÅ', 'üíº', 'üìã', '‚≠ê', 'üéØ', 'üí°', 'üî•', 'üíé',
    'üöÄ', '‚ö°', 'üåü', 'üí´', 'üé™', 'üé®', 'üé≠', 'üì±',
    '‚öôÔ∏è', 'üîß', 'üè∑Ô∏è', 'üìå', 'üìç', 'üó∫Ô∏è', 'üß≠', '‚è∞',
    '‚è±Ô∏è', '‚è≤Ô∏è', 'üï∞Ô∏è', '‚åö', 'üìÖ', 'üìÜ', 'üóìÔ∏è', 'üìá',
    'üóÉÔ∏è', 'üóÑÔ∏è', 'üìÇ', 'üìÅ', 'üóÇÔ∏è', 'üìã', 'üìä', 'üìà'
  ]
};

/**
 * Mapeamento de sin√¥nimos e varia√ß√µes para categorias principais
 */
const sinonimos = {
  // Finan√ßas
  'finan√ßas': 'financas',
  'dinheiro': 'financas',
  'banco': 'financas',
  'investimento': 'financas',
  'poupan√ßa': 'financas',
  'poupanca': 'financas',
  'cart√£o': 'financas',
  'cartao': 'financas',
  'empr√©stimo': 'financas',
  'emprestimo': 'financas',
  'sal√°rio': 'financas',
  'salario': 'financas',

  // Alimenta√ß√£o
  'alimenta√ß√£o': 'alimentacao',
  'comida': 'alimentacao',
  'restaurante': 'alimentacao',
  'supermercado': 'alimentacao',
  'mercado': 'alimentacao',
  'lanche': 'alimentacao',
  'fast food': 'alimentacao',
  'delivery': 'alimentacao',
  'feira': 'alimentacao',
  'a√ßougue': 'alimentacao',

  // Transporte
  'carro': 'transporte',
  'combust√≠vel': 'transporte',
  'combustivel': 'transporte',
  'gasolina': 'transporte',
  'uber': 'transporte',
  'taxi': 'transporte',
  '√¥nibus': 'transporte',
  'onibus': 'transporte',
  'metr√¥': 'transporte',
  'metro': 'transporte',
  'trem': 'transporte',
  'avi√£o': 'transporte',
  'aviao': 'transporte',

  // Moradia
  'casa': 'moradia',
  'aluguel': 'moradia',
  'condom√≠nio': 'moradia',
  'condominio': 'moradia',
  'energia': 'moradia',
  'luz': 'moradia',
  '√°gua': 'moradia',
  'agua': 'moradia',
  'g√°s': 'moradia',
  'gas': 'moradia',
  'internet': 'moradia',

  // Sa√∫de
  'sa√∫de': 'saude',
  'm√©dico': 'saude',
  'medico': 'saude',
  'hospital': 'saude',
  'farm√°cia': 'saude',
  'farmacia': 'saude',
  'medicamento': 'saude',
  'dentista': 'saude',
  'consulta': 'saude',

  // Educa√ß√£o
  'educa√ß√£o': 'educacao',
  'escola': 'educacao',
  'curso': 'educacao',
  'livro': 'educacao',
  'faculdade': 'educacao',
  'universidade': 'educacao',
  'material escolar': 'educacao',

  // Trabalho
  'escrit√≥rio': 'trabalho',
  'escritorio': 'trabalho',
  'office': 'trabalho',
  'reuni√£o': 'trabalho',
  'reuniao': 'trabalho',
  'projeto': 'trabalho',

  // Lazer
  'cinema': 'lazer',
  'filme': 'lazer',
  'jogo': 'lazer',
  'divers√£o': 'lazer',
  'diversao': 'lazer',
  'festa': 'lazer',
  'm√∫sica': 'lazer',
  'musica': 'lazer',

  // Pets
  'pet': 'pets',
  'cachorro': 'pets',
  'gato': 'pets',
  'veterin√°rio': 'pets',
  'veterinario': 'pets',
  'vet': 'pets',

  // Esportes
  'esporte': 'esportes',
  'futebol': 'esportes',
  'academia': 'esportes',
  'gin√°stica': 'esportes',
  'ginastica': 'esportes',

  // Fam√≠lia
  'fam√≠lia': 'familia',
  'crian√ßa': 'familia',
  'crianca': 'familia',
  'beb√™': 'familia',
  'bebe': 'familia',

  // Compras
  'shopping': 'compras',
  'roupa': 'compras',
  'vestu√°rio': 'compras',
  'vestuario': 'compras'
};

/**
 * Mapeamento para busca por palavras-chave
 */
const buscaPorPalavra = {
  'casa': ['üè†', 'üè°', 'üõèÔ∏è', 'üõãÔ∏è', 'üö™', 'üîë', 'üí°'],
  'dinheiro': ['üí∞', 'üíµ', 'üí≥', 'üè¶', 'üíé', 'üí∏', 'üìä'],
  'comida': ['üçΩÔ∏è', 'üçï', 'üçî', 'ü•ó', 'üçú', 'ü•ò', 'üçñ'],
  'carro': ['üöó', 'üöï', 'üöô', '‚õΩ', 'üÖøÔ∏è', 'üöß'],
  'trabalho': ['üíº', 'üíª', 'üìä', 'üìà', 'üè¢', 'üëî'],
  'saude': ['üè•', 'üíä', 'ü©∫', 'üë®‚Äç‚öïÔ∏è', 'üíâ', '‚öïÔ∏è'],
  'escola': ['üè´', 'üìö', 'üìñ', '‚úèÔ∏è', 'üéì', 'üë©‚Äçüè´'],
  'diversao': ['üéâ', 'üéÆ', 'üé¨', 'üéµ', 'üé™', 'üé®'],
  'esporte': ['‚öΩ', 'üèÄ', 'üéæ', 'üèÜ', 'üí™', 'üèÉ'],
  'pet': ['üê∂', 'üê±', 'üêæ', 'ü¶¥', 'üíñ', 'üè†'],
  'viagem': ['‚úàÔ∏è', 'üèñÔ∏è', 'üóª', 'üß≥', 'üì∏', 'üåç'],
  'familia': ['üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üë∂', 'üíï', 'üéÇ', 'üè†', '‚ù§Ô∏è'],
  'compras': ['üõçÔ∏è', 'üõí', 'üè™', 'üí≥', 'üëï', 'üëû']
};

/**
 * Classe principal para gerenciar √≠cones - VERS√ÉO UNIFICADA
 */
class CategoriaIcons {
  
  /**
   * Obt√©m √≠cones sugeridos para uma categoria
   * @param {string} categoriaNome - Nome da categoria
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @param {number} limite - N√∫mero m√°ximo de √≠cones
   * @returns {Array} Array de √≠cones
   */
  static getSuggestedIcons(categoriaNome, tipoIcone = 'emoji', limite = 24) {
    const nome = this.normalizarNome(categoriaNome);
    
    // Buscar categoria principal
    const categoriaKey = sinonimos[nome] || nome;
    
    // Selecionar biblioteca baseada no tipo
    const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
    
    // Obter √≠cones da categoria
    let icones = biblioteca[categoriaKey] || biblioteca['outros'] || [];
    
    // Se n√£o encontrou nada, tentar busca por palavra-chave
    if (icones.length === 0) {
      icones = this.buscarPorPalavraChave(nome, tipoIcone);
    }
    
    return icones.slice(0, limite);
  }
  
  /**
   * Obt√©m √≠cones padr√£o para quando n√£o h√° categoria espec√≠fica
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @returns {Array} Array de √≠cones padr√£o
   */
  static getDefaultIcons(tipoIcone = 'emoji') {
    if (tipoIcone === 'material') {
      return [
        'folder', 'star_outline', 'label', 'push_pin', 'menu_book', 
        'settings', 'build', 'business_center', 'show_chart', 'trending_up',
        'description', 'assignment', 'lightbulb_outline', 'target', 'flash_on',
        'diamond', 'auto_awesome', 'rocket_launch'
      ];
    } else {
      return [
        'üìÅ', 'üíº', 'üìã', '‚≠ê', 'üéØ', 'üí°', 'üî•', 'üíé',
        'üöÄ', '‚ö°', 'üåü', 'üí´', 'üé™', 'üé®', 'üé≠', 'üé¨',
        'üéÆ', 'üì±', 'üíª', 'üìä', 'üìà', 'üí∞', 'üèÜ', 'üéâ'
      ];
    }
  }
  
  /**
   * Busca √≠cones por palavra-chave ou termo
   * @param {string} termo - Termo de busca
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @returns {Array} Array de √≠cones encontrados
   */
  static searchIcons(termo, tipoIcone = 'emoji') {
    const termoBusca = this.normalizarNome(termo);
    
    // Buscar por palavra-chave direta
    if (buscaPorPalavra[termoBusca]) {
      return buscaPorPalavra[termoBusca];
    }
    
    // Buscar por sin√¥nimos
    const categoriaEncontrada = sinonimos[termoBusca];
    if (categoriaEncontrada) {
      const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
      const icones = biblioteca[categoriaEncontrada];
      if (icones) {
        return icones.slice(0, 20);
      }
    }
    
    // Buscar parcialmente nas palavras-chave
    for (const [palavra, icones] of Object.entries(buscaPorPalavra)) {
      if (palavra.includes(termoBusca) || termoBusca.includes(palavra)) {
        return icones;
      }
    }
    
    // Busca fuzzy em categorias
    const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
    for (const [categoria, icones] of Object.entries(biblioteca)) {
      if (categoria.includes(termoBusca) || termoBusca.includes(categoria)) {
        return icones.slice(0, 15);
      }
    }
    
    // Se n√£o encontrou nada, retornar √≠cones padr√£o
    return this.getDefaultIcons(tipoIcone).slice(0, 10);
  }
  
  /**
   * Busca por palavra-chave espec√≠fica
   * @param {string} palavra - Palavra a buscar
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @returns {Array} Array de √≠cones
   */
  static buscarPorPalavraChave(palavra, tipoIcone = 'emoji') {
    if (buscaPorPalavra[palavra]) {
      return buscaPorPalavra[palavra];
    }
    
    // Buscar em categorias relacionadas
    const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
    const resultados = [];
    
    for (const [categoria, icones] of Object.entries(biblioteca)) {
      if (categoria.includes(palavra) || palavra.includes(categoria)) {
        resultados.push(...icones.slice(0, 5));
      }
    }
    
    return resultados.length > 0 ? resultados : this.getDefaultIcons(tipoIcone);
  }
  
  /**
   * Normaliza nome removendo acentos e convertendo para min√∫sculo
   * @param {string} nome - Nome a normalizar
   * @returns {string} Nome normalizado
   */
  static normalizarNome(nome) {
    return nome.toLowerCase()
      .normalize('NFD')
      .replace(/[\u0300-\u036f]/g, '')
      .trim();
  }
  
  /**
   * Valida se um √≠cone √© v√°lido
   * @param {string} icone - √çcone a validar
   * @returns {boolean} Se √© v√°lido
   */
  static validateIcon(icone) {
    // Verifica√ß√£o se √© um emoji
    return /[\u{1F000}-\u{1F9FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(icone) || 
           icone.length <= 3; // Para caracteres especiais simples
  }
  
  /**
   * Obt√©m um √≠cone aleat√≥rio de uma categoria
   * @param {string} categoria - Categoria base
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @returns {string} √çcone aleat√≥rio
   */
  static getRandomIcon(categoria = 'outros', tipoIcone = 'emoji') {
    const icones = this.getSuggestedIcons(categoria, tipoIcone, 50);
    return icones[Math.floor(Math.random() * icones.length)] || 'üìÅ';
  }
  
  /**
   * Obt√©m todas as categorias dispon√≠veis
   * @returns {Array} Lista de categorias
   */
  static getCategorias() {
    return Object.keys(iconesEmoji);
  }
  
  /**
   * Obt√©m √≠cones por categoria espec√≠fica
   * @param {string} categoria - Nome da categoria
   * @param {string} tipoIcone - 'emoji' ou 'material'
   * @returns {Array} √çcones da categoria
   */
  static getIconsByCategory(categoria, tipoIcone = 'emoji') {
    const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
    const categoriaKey = this.normalizarNome(categoria);
    const categoriaFinal = sinonimos[categoriaKey] || categoriaKey;
    
    return biblioteca[categoriaFinal] || [];
  }
  
  /**
   * Obt√©m sugest√µes de √≠cones para categoria brasileira
   * @param {string} nomeCategoria - Nome em portugu√™s
   * @returns {Array} √çcones sugeridos
   */
  static getSuggestionsForBrazilianCategory(nomeCategoria) {
    const categoriaMap = {
      'alimenta√ß√£o': ['üçΩÔ∏è', 'üçï', 'üçî', 'ü•ó', '‚òï', 'üçû', 'ü•ê', 'üçé'],
      'transporte': ['üöó', 'üöå', 'üöá', '‚úàÔ∏è', '‚õΩ', 'üö≤', 'üõµ', 'üöï'],
      'moradia': ['üè†', 'üí°', 'üíß', 'üî•', 'üîë', 'üõèÔ∏è', 'üöø', 'üì∫'],
      'sa√∫de': ['üè•', 'üíä', 'ü©∫', 'üíâ', 'ü¶∑', 'üë®‚Äç‚öïÔ∏è', 'üßò', 'üí™'],
      'educa√ß√£o': ['üìö', '‚úèÔ∏è', 'üéì', 'üè´', 'üíª', 'üìñ', 'üìù', 'üî¨'],
      'trabalho': ['üíº', 'üíª', 'üìä', 'üè¢', '‚òéÔ∏è', 'üìß', '‚è∞', 'üìÖ'],
      'lazer': ['üéÆ', 'üé¨', 'üéµ', 'üé®', 'üé™', 'üéØ', 'üé≤', 'üé≠'],
      'fam√≠lia': ['üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üë∂', 'üéÇ', 'üíï', 'üè†', 'üéÅ', 'üì∑', '‚ù§Ô∏è'],
      'pets': ['üê∂', 'üê±', 'üêæ', 'ü¶¥', 'üíñ', 'üè†', 'ü•é', 'üêï'],
      'compras': ['üõçÔ∏è', 'üõí', 'üí≥', 'üëï', 'üëû', 'üè™', 'üíÑ', 'üì±']
    };
    
    const categoria = this.normalizarNome(nomeCategoria);
    return categoriaMap[categoria] || this.getDefaultIcons('emoji');
  }
  
  /**
   * Obt√©m estat√≠sticas da biblioteca
   * @returns {Object} Estat√≠sticas
   */
  static getStats() {
    const totalEmojis = Object.values(iconesEmoji)
      .reduce((total, arr) => total + arr.length, 0);
    
    const totalMaterial = Object.values(iconesMaterial)
      .reduce((total, arr) => total + arr.length, 0);
    
    return {
      totalIcones: totalEmojis + totalMaterial,
      iconesEmoji: totalEmojis,
      iconesMaterial: totalMaterial,
      categorias: Object.keys(iconesEmoji).length,
      sinonimos: Object.keys(sinonimos).length,
      palavrasChave: Object.keys(buscaPorPalavra).length
    };
  }
  
  /**
   * Obt√©m √≠cones mais populares por categoria
   * @param {string} categoria - Categoria
   * @param {number} limite - Limite de √≠cones
   * @returns {Array} √çcones mais usados
   */
  static getPopularIcons(categoria = null, limite = 12) {
    if (categoria) {
      return this.getSuggestedIcons(categoria, 'emoji', limite);
    }
    
    // √çcones mais populares gerais
    return [
      'üí∞', 'üè†', 'üçΩÔ∏è', 'üöó', 'üè•', 'üìö', 'üíº', 'üéÆ',
      'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üê∂', '‚úàÔ∏è', 'üõçÔ∏è', '‚öΩ', 'üé¨', '‚òï', 'üì±',
      'üí°', 'üéØ', 'üî•', '‚≠ê', 'üíé', 'üöÄ', 'üåü', 'üèÜ'
    ].slice(0, limite);
  }
  
  /**
   * Pesquisa avan√ßada com m√∫ltiplos termos
   * @param {string} query - Query de busca
   * @param {string} tipoIcone - Tipo de √≠cone
   * @param {number} limite - Limite de resultados
   * @returns {Array} √çcones encontrados
   */
  static advancedSearch(query, tipoIcone = 'emoji', limite = 20) {
    const termos = query.toLowerCase().split(' ').map(t => t.trim());
    const resultados = new Set();
    
    termos.forEach(termo => {
      const icones = this.searchIcons(termo, tipoIcone);
      icones.forEach(icone => resultados.add(icone));
    });
    
    return Array.from(resultados).slice(0, limite);
  }
  
  /**
   * Filtra √≠cones por tema ou contexto
   * @param {string} tema - Tema (ex: 'business', 'personal', 'fun')
   * @param {string} tipoIcone - Tipo de √≠cone
   * @returns {Array} √çcones do tema
   */
  static getIconsByTheme(tema, tipoIcone = 'emoji') {
    const temas = {
      'business': ['financas', 'trabalho'],
      'personal': ['familia', 'saude', 'educacao'],
      'fun': ['lazer', 'esportes', 'viagem'],
      'daily': ['alimentacao', 'transporte', 'moradia'],
      'care': ['pets', 'familia', 'saude']
    };
    
    const categorias = temas[tema] || ['outros'];
    const biblioteca = tipoIcone === 'material' ? iconesMaterial : iconesEmoji;
    const resultados = [];
    
    categorias.forEach(categoria => {
      if (biblioteca[categoria]) {
        resultados.push(...biblioteca[categoria].slice(0, 8));
      }
    });
    
    return resultados;
  }
  
  /**
   * Valida e sanitiza entrada de √≠cone
   * @param {string} icone - √çcone a validar
   * @returns {string} √çcone validado ou padr√£o
   */
  static sanitizeIcon(icone) {
    if (!icone || typeof icone !== 'string') {
      return 'üìÅ';
    }
    
    // Remove espa√ßos e caracteres especiais
    const cleaned = icone.trim();
    
    if (this.validateIcon(cleaned)) {
      return cleaned;
    }
    
    return 'üìÅ';
  }
}

// =====================================
// EXPORTA√á√ïES PARA COMPATIBILIDADE
// =====================================

/**
 * Exporta√ß√µes nomeadas para manter compatibilidade com c√≥digo existente
 */
export const getIconSuggestions = (nome, tipo = 'emoji', limite = 24) => {
  return CategoriaIcons.getSuggestedIcons(nome, tipo, limite);
};

export const searchIcons = (termo, tipo = 'emoji') => {
  return CategoriaIcons.searchIcons(termo, tipo);
};

export const getRandomIcon = (categoria = 'outros', tipo = 'emoji') => {
  return CategoriaIcons.getRandomIcon(categoria, tipo);
};

export const validateIcon = (icone) => {
  return CategoriaIcons.validateIcon(icone);
};

export const getDefaultIcons = (tipo = 'emoji') => {
  return CategoriaIcons.getDefaultIcons(tipo);
};

export const getPopularIcons = (categoria = null, limite = 12) => {
  return CategoriaIcons.getPopularIcons(categoria, limite);
};

export const getBrazilianSuggestions = (categoria) => {
  return CategoriaIcons.getSuggestionsForBrazilianCategory(categoria);
};

// =====================================
// CONSTANTES EXPORTADAS
// =====================================

/**
 * Lista das categorias principais
 */
export const CATEGORIAS_PRINCIPAIS = [
  'financas',
  'alimentacao',
  'transporte', 
  'moradia',
  'saude',
  'educacao',
  'trabalho',
  'lazer',
  'esportes',
  'familia',
  'pets',
  'viagem',
  'compras',
  'outros'
];

/**
 * Tipos de √≠cones dispon√≠veis
 */
export const TIPOS_ICONES = {
  EMOJI: 'emoji',
  MATERIAL: 'material'
};

/**
 * Temas predefinidos
 */
export const TEMAS_ICONES = {
  BUSINESS: 'business',
  PERSONAL: 'personal',
  FUN: 'fun',
  DAILY: 'daily',
  CARE: 'care'
};

/**
 * √çcones mais populares para quick access
 */
export const ICONES_POPULARES = [
  'üí∞', 'üè†', 'üçΩÔ∏è', 'üöó', 'üè•', 'üìö', 'üíº', 'üéÆ',
  'üë®‚Äçüë©‚Äçüëß‚Äçüë¶', 'üê∂', '‚úàÔ∏è', 'üõçÔ∏è', '‚öΩ', 'üé¨', '‚òï', 'üì±'
];

/**
 * Cores sugeridas por categoria
 */
export const CORES_POR_CATEGORIA = {
  'financas': ['#2E7D32', '#388E3C', '#43A047', '#4CAF50'],
  'alimentacao': ['#E64A19', '#F57C00', '#FF9800', '#FFC107'],
  'transporte': ['#1976D2', '#1E88E5', '#2196F3', '#03A9F4'],
  'moradia': ['#5D4037', '#6D4C41', '#795548', '#8D6E63'],
  'saude': ['#C2185B', '#E91E63', '#F06292', '#F48FB1'],
  'educacao': ['#512DA8', '#673AB7', '#9C27B0', '#BA68C8'],
  'trabalho': ['#455A64', '#546E7A', '#607D8B', '#78909C'],
  'lazer': ['#FF5722', '#FF7043', '#FF8A65', '#FFAB91'],
  'esportes': ['#FF6F00', '#FF8F00', '#FFA000', '#FFB300'],
  'familia': ['#AD1457', '#C2185B', '#E91E63', '#F06292'],
  'pets': ['#8BC34A', '#9CCC65', '#AED581', '#C5E1A5'],
  'viagem': ['#00ACC1', '#26C6DA', '#4DD0E1', '#80DEEA'],
  'compras': ['#8E24AA', '#9C27B0', '#AB47BC', '#BA68C8'],
  'outros': ['#424242', '#616161', '#757575', '#9E9E9E']
};

// =====================================
// UTILIT√ÅRIOS ADICIONAIS
// =====================================

/**
 * Utilit√°rio para debug e desenvolvimento
 */
export const DEBUG_UTILS = {
  listAllIcons: () => {
    console.log('üìä Estat√≠sticas da biblioteca:', CategoriaIcons.getStats());
    console.log('üìÇ Categorias dispon√≠veis:', CategoriaIcons.getCategorias());
  },
  
  testSearch: (termo) => {
    console.log(`üîç Busca por "${termo}":`);
    console.log('Emojis:', CategoriaIcons.searchIcons(termo, 'emoji'));
    console.log('Material:', CategoriaIcons.searchIcons(termo, 'material'));
  },
  
  validateLibrary: () => {
    const stats = CategoriaIcons.getStats();
    console.log('‚úÖ Biblioteca validada:', stats);
    return stats.totalIcones > 0;
  }
};

/**
 * Export default da classe principal
 */
export default CategoriaIcons;